<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Magic Card: Gradient QR</title>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        :root { --bg: #f3f4f6; --surface: #ffffff; --text: #1f2937; --primary: #6366f1; }
        body { font-family: 'Inter', system-ui, sans-serif; background: var(--bg); display: flex; height: 100vh; margin: 0; overflow: hidden; color: var(--text); }

        /* --- LAYOUT --- */
        .app-container { display: flex; width: 100%; height: 100%; }

        /* LEFT: CONTROL PANEL */
        .input-panel { width: 440px; background: var(--surface); padding: 30px; border-right: 1px solid #e5e7eb; display: flex; flex-direction: column; z-index: 10; box-shadow: 4px 0 24px rgba(0,0,0,0.05); overflow-y: auto; }
        .brand { font-size: 20px; font-weight: 800; color: var(--text); margin-bottom: 5px; display: flex; align-items: center; gap: 10px; }
        .subtitle { font-size: 13px; color: #6b7280; margin-bottom: 25px; }

        .control-section { margin-bottom: 25px; border-bottom: 1px solid #f3f4f6; padding-bottom: 20px; }
        .control-title { font-size: 11px; font-weight: 800; text-transform: uppercase; color: #9ca3af; margin-bottom: 10px; letter-spacing: 0.5px; }
        .sub-label { font-size: 10px; font-weight: 700; color: #6b7280; margin-bottom: 6px; display: block; letter-spacing: 0.5px; }

        /* INPUTS */
        .smart-input-container { position: relative; margin-bottom: 10px; }
        .smart-input { width: 100%; padding: 12px 12px 12px 35px; border: 2px solid #e5e7eb; border-radius: 10px; font-size: 13px; transition: 0.2s; box-sizing: border-box; background: #f9fafb; }
        .smart-input:focus { border-color: var(--primary); background: #fff; outline: none; }
        .input-icon { position: absolute; left: 12px; top: 13px; color: #9ca3af; font-size: 14px; }
        .std-input { width: 100%; padding: 10px; border: 1px solid #e5e7eb; border-radius: 8px; font-size: 13px; box-sizing: border-box; margin-bottom: 8px; }

        /* STATS INPUTS */
        .stat-input-group { display: flex; gap: 8px; margin-bottom: 8px; }
        .emoji-input { width: 40px; text-align: center; padding: 8px; border: 1px solid #e5e7eb; border-radius: 8px; font-size: 14px; background: #f9fafb; }
        .text-input { flex: 1; padding: 8px; border: 1px solid #e5e7eb; border-radius: 8px; font-size: 13px; background: #f9fafb; }
        
        /* PRESET BUTTONS */
        .preset-bar { display: flex; gap: 5px; margin-bottom: 10px; }
        .preset-btn { font-size: 10px; padding: 4px 8px; border: 1px solid #e5e7eb; border-radius: 4px; background: white; cursor: pointer; color: #666; transition: 0.2s; }
        .preset-btn:hover { border-color: var(--primary); color: var(--primary); background: #eff6ff; }

        /* BUTTON GRIDS */
        .option-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px; margin-bottom: 15px; }
        .texture-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; margin-bottom: 8px; }
        .fx-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 6px; }

        .option-btn { padding: 8px; border: 1px solid #e5e7eb; border-radius: 8px; background: #f9fafb; cursor: pointer; font-size: 10px; font-weight: 600; color: #4b5563; transition: 0.2s; display: flex; align-items: center; justify-content: center; gap: 4px; height: 32px; }
        .option-btn:hover { border-color: var(--primary); color: var(--primary); }
        .option-btn.active { background: var(--primary); border-color: var(--primary); color: white; box-shadow: 0 2px 6px rgba(99, 102, 241, 0.3); }

        /* QR COLOR PICKERS */
        .qr-color-controls { display: flex; align-items: center; gap: 10px; margin-top: 10px; background: #f0fdf4; padding: 10px; border-radius: 8px; border: 1px dashed #4ade80; }
        .color-input { width: 30px; height: 30px; border: none; cursor: pointer; background: none; }

        /* RIGHT: PREVIEW */
        .preview-panel { flex: 1; background: #e5e7eb; background-image: radial-gradient(#d1d5db 1px, transparent 1px); background-size: 20px 20px; display: flex; flex-direction: column; justify-content: center; align-items: center; }

        /* --- CARD ARCHITECTURE --- */
        .card-wrapper { position: relative; background: white; box-shadow: 0 30px 60px rgba(0,0,0,0.2); overflow: hidden; display: flex; transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1); transform-style: preserve-3d; }
        .format-landscape { width: 480px; height: 280px; border-radius: 24px; }
        .format-portrait { width: 320px; height: 568px; border-radius: 30px; flex-direction: column; }

        /* LAYERS */
        .layer-base { position: absolute; top:0; left:0; width:10
